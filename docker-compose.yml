services:
  # 1. The PHP Engine
  php-app:
    build: ./php           # Points to the new php/Dockerfile
    volumes:
      - ./html:/var/www/html # Mounts your code into the PHP container
    depends_on:
      - db

  # 2. The Web Server (Nginx)
  web:
    image: nginx:stable-alpine
    ports:
      - "8080:80"
    volumes:
      - ./html:/var/www/html:ro  # Nginx needs to see static files
      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf:ro # Your config
    depends_on:
      - php-app

  # 3. The Database
  db:
    image: mysql:9.0
    environment:
      MYSQL_DATABASE: myapp
      MYSQL_ROOT_PASSWORD: root
    volumes:
      - ./mysql:/var/lib/mysql  # Uses your new mysql/ folder for data

# Define volumes if you prefer named volumes, but ./mysql is easier for now

